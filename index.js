const fs = require('fs')
const path = require('path')
var arrayListPackageShaiHulud = [
    "@ahmedhfarag/ngx-perfect-scrollbar@20.0.20",
    "@ahmedhfarag/ngx-virtual-scroller@4.0.4",
    "ahmedhfarag",
    "ex",
    "@art-ws/common@2.0.22",
    "@art-ws/common@2.0.28",
    "@art-ws/config-eslint@2.0.4",
    "@art-ws/config-eslint@2.0.5",
    "@art-ws/config-ts@2.0.7",
    "@art-ws/config-ts@2.0.8",
    "@art-ws/db-context@2.0.21",
    "@art-ws/db-context@2.0.24",
    "@art-ws/di-node@2.0.13",
    "@art-ws/di@2.0.28",
    "@art-ws/di@2.0.32",
    "@art-ws/eslint@1.0.5",
    "@art-ws/eslint@1.0.6",
    "@art-ws/fastify-http-server@2.0.24",
    "@art-ws/fastify-http-server@2.0.27",
    "@art-ws/http-server@2.0.21",
    "@art-ws/http-server@2.0.25",
    "@art-ws/openapi@0.1.12",
    "@art-ws/openapi@0.1.9",
    "@art-ws/package-base@1.0.5",
    "@art-ws/package-base@1.0.6",
    "@art-ws/prettier@1.0.5",
    "@art-ws/prettier@1.0.6",
    "@art-ws/slf@2.0.15",
    "@art-ws/slf@2.0.22",
    "@art-ws/ssl-info@1.0.10",
    "@art-ws/ssl-info@1.0.9",
    "@art-ws/web-app@1.0.3",
    "@art-ws/web-app@1.0.4",
    "art-ws",
    "@basic-ui-components-stc/basic-ui-components@1.0.5",
    "@crowdstrike/commitlint@8.1.1",
    "@crowdstrike/commitlint@8.1.2",
    "@crowdstrike/falcon-shoelace@0.4.1",
    "@crowdstrike/falcon-shoelace@0.4.2",
    "@crowdstrike/foundry-js@0.19.1",
    "@crowdstrike/foundry-js@0.19.2",
    "@crowdstrike/glide-core@0.34.2",
    "@crowdstrike/glide-core@0.34.3",
    "@crowdstrike/logscale-dashboard@1.205.1",
    "@crowdstrike/logscale-dashboard@1.205.2",
    "@crowdstrike/logscale-file-editor@1.205.1",
    "@crowdstrike/logscale-file-editor@1.205.2",
    "@crowdstrike/logscale-parser-edit@1.205.1",
    "@crowdstrike/logscale-parser-edit@1.205.2",
    "@crowdstrike/logscale-search@1.205.1",
    "@crowdstrike/logscale-search@1.205.2",
    "@crowdstrike/tailwind-toucan-base@5.0.1",
    "@crowdstrike/tailwind-toucan-base@5.0.2",
    "crowdstrike",
    "@ctrl/deluge@7.2.1",
    "@ctrl/deluge@7.2.2",
    "@ctrl/golang-template@1.4.2",
    "@ctrl/golang-template@1.4.3",
    "@ctrl/magnet-link@4.0.3",
    "@ctrl/magnet-link@4.0.4",
    "@ctrl/ngx-codemirror@7.0.1",
    "@ctrl/ngx-codemirror@7.0.2",
    "@ctrl/ngx-csv@6.0.1",
    "@ctrl/ngx-csv@6.0.2",
    "@ctrl/ngx-emoji-mart@9.2.1",
    "@ctrl/ngx-emoji-mart@9.2.2",
    "@ctrl/ngx-rightclick@4.0.1",
    "@ctrl/ngx-rightclick@4.0.2",
    "@ctrl/qbittorrent@9.7.1",
    "@ctrl/qbittorrent@9.7.2",
    "@ctrl/react-adsense@2.0.1",
    "@ctrl/react-adsense@2.0.2",
    "@ctrl/shared-torrent@6.3.1",
    "@ctrl/shared-torrent@6.3.2",
    "@ctrl/tinycolor@4.1.1",
    "@ctrl/tinycolor@4.1.2",
    "@ctrl/torrent-file@4.1.1",
    "@ctrl/torrent-file@4.1.2",
    "@ctrl/transmission@7.3.1",
    "@ctrl/ts-base32@4.0.1",
    "@ctrl/ts-base32@4.0.2",
    "ctrl",
    "@hestjs/core@0.2.1",
    "@hestjs/cqrs@0.1.6",
    "@hestjs/demo@0.1.2",
    "@hestjs/eslint-config@0.1.2",
    "@hestjs/logger@0.1.6",
    "@hestjs/scalar@0.1.7",
    "@hestjs/validation@0.1.6",
    "hestjs",
    "@nativescript-community/arraybuffers@1.1.6",
    "@nativescript-community/arraybuffers@1.1.7",
    "@nativescript-community/arraybuffers@1.1.8",
    "@nativescript-community/gesturehandler@2.0.35",
    "@nativescript-community/perms@3.0.5",
    "@nativescript-community/perms@3.0.6",
    "@nativescript-community/perms@3.0.7",
    "@nativescript-community/perms@3.0.8",
    "@nativescript-community/perms@3.0.9",
    "@nativescript-community/sentry@4.6.43",
    "@nativescript-community/sqlite@3.5.2",
    "@nativescript-community/sqlite@3.5.3",
    "@nativescript-community/sqlite@3.5.4",
    "@nativescript-community/sqlite@3.5.5",
    "@nativescript-community/text@1.6.10",
    "@nativescript-community/text@1.6.11",
    "@nativescript-community/text@1.6.12",
    "@nativescript-community/text@1.6.13",
    "@nativescript-community/text@1.6.9",
    "@nativescript-community/typeorm@0.2.30",
    "@nativescript-community/typeorm@0.2.31",
    "@nativescript-community/typeorm@0.2.32",
    "@nativescript-community/typeorm@0.2.33",
    "@nativescript-community/ui-collectionview@6.0.6",
    "@nativescript-community/ui-document-picker@1.1.27",
    "@nativescript-community/ui-document-picker@1.1.28",
    "@nativescript-community/ui-drawer@0.1.30",
    "@nativescript-community/ui-image@4.5.6",
    "@nativescript-community/ui-label@1.3.35",
    "@nativescript-community/ui-label@1.3.36",
    "@nativescript-community/ui-label@1.3.37",
    "@nativescript-community/ui-material-bottom-navigation@7.2.72",
    "@nativescript-community/ui-material-bottom-navigation@7.2.73",
    "@nativescript-community/ui-material-bottom-navigation@7.2.74",
    "@nativescript-community/ui-material-bottom-navigation@7.2.75",
    "@nativescript-community/ui-material-bottomsheet@7.2.72",
    "@nativescript-community/ui-material-core-tabs@7.2.72",
    "@nativescript-community/ui-material-core-tabs@7.2.73",
    "@nativescript-community/ui-material-core-tabs@7.2.74",
    "@nativescript-community/ui-material-core-tabs@7.2.75",
    "@nativescript-community/ui-material-core-tabs@7.2.76",
    "@nativescript-community/ui-material-core@7.2.72",
    "@nativescript-community/ui-material-core@7.2.73",
    "@nativescript-community/ui-material-core@7.2.74",
    "@nativescript-community/ui-material-core@7.2.75",
    "@nativescript-community/ui-material-core@7.2.76",
    "@nativescript-community/ui-material-ripple@7.2.72",
    "@nativescript-community/ui-material-ripple@7.2.73",
    "@nativescript-community/ui-material-ripple@7.2.74",
    "@nativescript-community/ui-material-ripple@7.2.75",
    "@nativescript-community/ui-material-tabs@7.2.72",
    "@nativescript-community/ui-material-tabs@7.2.73",
    "@nativescript-community/ui-material-tabs@7.2.74",
    "@nativescript-community/ui-material-tabs@7.2.75",
    "@nativescript-community/ui-pager@14.1.35",
    "@nativescript-community/ui-pager@14.1.36",
    "@nativescript-community/ui-pager@14.1.37",
    "@nativescript-community/ui-pager@14.1.38",
    "@nativescript-community/ui-pulltorefresh@2.5.4",
    "@nativescript-community/ui-pulltorefresh@2.5.5",
    "@nativescript-community/ui-pulltorefresh@2.5.6",
    "@nativescript-community/ui-pulltorefresh@2.5.7",
    "nativescript-community",
    "@nexe/config-manager@0.1.1",
    "@nexe/eslint-config@0.1.1",
    "@nexe/logger@0.1.3",
    "nexe",
    "@nstudio/angular@20.0.4",
    "@nstudio/angular@20.0.5",
    "@nstudio/angular@20.0.6",
    "@nstudio/focus@20.0.4",
    "@nstudio/focus@20.0.5",
    "@nstudio/focus@20.0.6",
    "@nstudio/nativescript-checkbox@2.0.6",
    "@nstudio/nativescript-checkbox@2.0.7",
    "@nstudio/nativescript-checkbox@2.0.8",
    "@nstudio/nativescript-checkbox@2.0.9",
    "@nstudio/nativescript-loading-indicator@5.0.1",
    "@nstudio/nativescript-loading-indicator@5.0.2",
    "@nstudio/nativescript-loading-indicator@5.0.3",
    "@nstudio/nativescript-loading-indicator@5.0.4",
    "@nstudio/ui-collectionview@5.1.11",
    "@nstudio/ui-collectionview@5.1.12",
    "@nstudio/ui-collectionview@5.1.13",
    "@nstudio/ui-collectionview@5.1.14",
    "@nstudio/web-angular@20.0.4",
    "@nstudio/web@20.0.4",
    "@nstudio/xplat-utils@20.0.4",
    "@nstudio/xplat-utils@20.0.5",
    "@nstudio/xplat-utils@20.0.6",
    "@nstudio/xplat-utils@20.0.7",
    "@nstudio/xplat@20.0.4",
    "@nstudio/xplat@20.0.5",
    "@nstudio/xplat@20.0.6",
    "@nstudio/xplat@20.0.7",
    "nstudio",
    "@operato/board@9.0.35",
    "@operato/board@9.0.36",
    "@operato/board@9.0.37",
    "@operato/board@9.0.38",
    "@operato/board@9.0.39",
    "@operato/board@9.0.40",
    "@operato/board@9.0.41",
    "@operato/board@9.0.42",
    "@operato/board@9.0.43",
    "@operato/board@9.0.44",
    "@operato/board@9.0.45",
    "@operato/board@9.0.46",
    "@operato/board@9.0.47",
    "@operato/board@9.0.48",
    "@operato/board@9.0.49",
    "@operato/board@9.0.50",
    "@operato/board@9.0.51",
    "@operato/data-grist@9.0.29",
    "@operato/data-grist@9.0.35",
    "@operato/data-grist@9.0.36",
    "@operato/data-grist@9.0.37",
    "@operato/graphql@9.0.22",
    "@operato/graphql@9.0.35",
    "@operato/graphql@9.0.36",
    "@operato/graphql@9.0.37",
    "@operato/graphql@9.0.38",
    "@operato/graphql@9.0.39",
    "@operato/graphql@9.0.40",
    "@operato/graphql@9.0.41",
    "@operato/graphql@9.0.42",
    "@operato/graphql@9.0.43",
    "@operato/graphql@9.0.44",
    "@operato/graphql@9.0.45",
    "@operato/graphql@9.0.46",
    "@operato/graphql@9.0.47",
    "@operato/graphql@9.0.48",
    "@operato/graphql@9.0.49",
    "@operato/graphql@9.0.50",
    "@operato/graphql@9.0.51",
    "@operato/headroom@9.0.2",
    "@operato/headroom@9.0.35",
    "@operato/headroom@9.0.36",
    "@operato/headroom@9.0.37",
    "@operato/help@9.0.35",
    "@operato/help@9.0.36",
    "@operato/help@9.0.37",
    "@operato/help@9.0.38",
    "@operato/help@9.0.39",
    "@operato/help@9.0.40",
    "@operato/help@9.0.41",
    "@operato/help@9.0.42",
    "@operato/help@9.0.43",
    "@operato/help@9.0.44",
    "@operato/help@9.0.45",
    "@operato/help@9.0.46",
    "@operato/help@9.0.47",
    "@operato/help@9.0.48",
    "@operato/help@9.0.49",
    "@operato/help@9.0.50",
    "@operato/help@9.0.51",
    "@operato/i18n@9.0.35",
    "@operato/i18n@9.0.36",
    "@operato/i18n@9.0.37",
    "@operato/input@9.0.27",
    "@operato/input@9.0.35",
    "@operato/input@9.0.36",
    "@operato/input@9.0.37",
    "@operato/input@9.0.38",
    "@operato/input@9.0.39",
    "@operato/input@9.0.40",
    "@operato/input@9.0.41",
    "@operato/input@9.0.42",
    "@operato/input@9.0.43",
    "@operato/input@9.0.44",
    "@operato/input@9.0.45",
    "@operato/input@9.0.46",
    "@operato/input@9.0.47",
    "@operato/input@9.0.48",
    "@operato/layout@9.0.35",
    "@operato/layout@9.0.36",
    "@operato/layout@9.0.37",
    "@operato/popup@9.0.22",
    "@operato/popup@9.0.35",
    "@operato/popup@9.0.36",
    "@operato/popup@9.0.37",
    "@operato/popup@9.0.38",
    "@operato/popup@9.0.39",
    "@operato/popup@9.0.40",
    "@operato/popup@9.0.41",
    "@operato/popup@9.0.42",
    "@operato/popup@9.0.43",
    "@operato/popup@9.0.44",
    "@operato/popup@9.0.45",
    "@operato/popup@9.0.46",
    "@operato/popup@9.0.47",
    "@operato/popup@9.0.48",
    "@operato/popup@9.0.49",
    "@operato/popup@9.0.50",
    "@operato/popup@9.0.51",
    "@operato/pull-to-refresh@9.0.35",
    "@operato/pull-to-refresh@9.0.36",
    "@operato/pull-to-refresh@9.0.37",
    "@operato/pull-to-refresh@9.0.38",
    "@operato/pull-to-refresh@9.0.39",
    "@operato/pull-to-refresh@9.0.40",
    "@operato/pull-to-refresh@9.0.41",
    "@operato/pull-to-refresh@9.0.42",
    "@operato/pull-to-refresh@9.0.43",
    "@operato/pull-to-refresh@9.0.44",
    "@operato/pull-to-refresh@9.0.45",
    "@operato/pull-to-refresh@9.0.46",
    "@operato/pull-to-refresh@9.0.47",
    "@operato/shell@9.0.22",
    "@operato/shell@9.0.35",
    "@operato/shell@9.0.36",
    "@operato/shell@9.0.37",
    "@operato/shell@9.0.38",
    "@operato/shell@9.0.39",
    "@operato/styles@9.0.2",
    "@operato/styles@9.0.35",
    "@operato/styles@9.0.36",
    "@operato/styles@9.0.37",
    "@operato/utils@9.0.22",
    "@operato/utils@9.0.35",
    "@operato/utils@9.0.36",
    "@operato/utils@9.0.37",
    "@operato/utils@9.0.38",
    "@operato/utils@9.0.39",
    "@operato/utils@9.0.40",
    "@operato/utils@9.0.41",
    "@operato/utils@9.0.42",
    "@operato/utils@9.0.43",
    "@operato/utils@9.0.44",
    "@operato/utils@9.0.45",
    "@operato/utils@9.0.46",
    "@operato/utils@9.0.47",
    "@operato/utils@9.0.48",
    "@operato/utils@9.0.49",
    "@operato/utils@9.0.50",
    "@operato/utils@9.0.51",
    "operato",
    "@teselagen/bio-parsers@0.4.29",
    "@teselagen/bio-parsers@0.4.30",
    "@teselagen/bounce-loader@0.3.16",
    "@teselagen/bounce-loader@0.3.17",
    "@teselagen/file-utils@0.3.21",
    "@teselagen/file-utils@0.3.22",
    "@teselagen/liquibase-tools@0.4.1",
    "@teselagen/ove@0.7.39",
    "@teselagen/ove@0.7.40",
    "@teselagen/range-utils@0.3.14",
    "@teselagen/range-utils@0.3.15",
    "@teselagen/react-list@0.8.19",
    "@teselagen/react-list@0.8.20",
    "@teselagen/react-table@6.10.19",
    "@teselagen/react-table@6.10.20",
    "@teselagen/react-table@6.10.21",
    "@teselagen/react-table@6.10.22",
    "@teselagen/sequence-utils@0.3.33",
    "@teselagen/sequence-utils@0.3.34",
    "@teselagen/ui@0.9.10",
    "@teselagen/ui@0.9.9",
    "teselagen",
    "@thangved/callback-window@1.1.4",
    "@things-factory/attachment-base@9.0.42",
    "@things-factory/attachment-base@9.0.43",
    "@things-factory/attachment-base@9.0.44",
    "@things-factory/attachment-base@9.0.45",
    "@things-factory/attachment-base@9.0.46",
    "@things-factory/attachment-base@9.0.47",
    "@things-factory/attachment-base@9.0.48",
    "@things-factory/attachment-base@9.0.49",
    "@things-factory/attachment-base@9.0.50",
    "@things-factory/attachment-base@9.0.51",
    "@things-factory/attachment-base@9.0.52",
    "@things-factory/attachment-base@9.0.53",
    "@things-factory/attachment-base@9.0.54",
    "@things-factory/attachment-base@9.0.55",
    "@things-factory/auth-base@9.0.42",
    "@things-factory/auth-base@9.0.43",
    "@things-factory/auth-base@9.0.44",
    "@things-factory/auth-base@9.0.45",
    "@things-factory/email-base@9.0.42",
    "@things-factory/email-base@9.0.43",
    "@things-factory/email-base@9.0.44",
    "@things-factory/email-base@9.0.45",
    "@things-factory/email-base@9.0.46",
    "@things-factory/email-base@9.0.47",
    "@things-factory/email-base@9.0.48",
    "@things-factory/email-base@9.0.49",
    "@things-factory/email-base@9.0.50",
    "@things-factory/email-base@9.0.51",
    "@things-factory/email-base@9.0.52",
    "@things-factory/email-base@9.0.53",
    "@things-factory/email-base@9.0.54",
    "@things-factory/email-base@9.0.55",
    "@things-factory/email-base@9.0.56",
    "@things-factory/email-base@9.0.57",
    "@things-factory/email-base@9.0.58",
    "@things-factory/email-base@9.0.59",
    "@things-factory/env@9.0.42",
    "@things-factory/env@9.0.43",
    "@things-factory/env@9.0.44",
    "@things-factory/env@9.0.45",
    "@things-factory/integration-base@9.0.42",
    "@things-factory/integration-base@9.0.43",
    "@things-factory/integration-base@9.0.44",
    "@things-factory/integration-base@9.0.45",
    "@things-factory/integration-marketplace@9.0.42",
    "@things-factory/integration-marketplace@9.0.43",
    "@things-factory/integration-marketplace@9.0.44",
    "@things-factory/integration-marketplace@9.0.45",
    "@things-factory/shell@9.0.42",
    "@things-factory/shell@9.0.43",
    "@things-factory/shell@9.0.44",
    "@things-factory/shell@9.0.45",
    "things-factory",
    "@tnf-dev/api@1.0.8",
    "@tnf-dev/core@1.0.8",
    "@tnf-dev/js@1.0.8",
    "@tnf-dev/mui@1.0.8",
    "@tnf-dev/react@1.0.8",
    "tnf-dev",
    "@ui-ux-gang/devextreme-angular-rpk@24.1.7",
    "@ui-ux-gang/devextreme-rpk@24.1.7",
    "ui-ux-gang",
    "@yoobic/design-system@6.5.17",
    "@yoobic/jpeg-camera-es6@1.0.13",
    "@yoobic/yobi@8.7.53",
    "yoobic",
    "ace-colorpicker-rpk@0.0.14",
    "airchief@0.3.1",
    "airpilot@0.8.8",
    "angulartics2@14.1.1",
    "angulartics2@14.1.2",
    "another-shai@1.0.1",
    "browser-webdriver-downloader@3.0.8",
    "capacitor-notificationhandler@0.0.2",
    "capacitor-notificationhandler@0.0.3",
    "capacitor-plugin-healthapp@0.0.2",
    "capacitor-plugin-healthapp@0.0.3",
    "capacitor-plugin-ihealth@1.1.8",
    "capacitor-plugin-ihealth@1.1.9",
    "capacitor-plugin-vonage@1.0.2",
    "capacitor-plugin-vonage@1.0.3",
    "capacitorandroidpermissions@0.0.4",
    "capacitorandroidpermissions@0.0.5",
    "config-cordova@0.8.5",
    "cordova-plugin-voxeet2@1.0.24",
    "cordova-voxeet@1.0.32",
    "create-hest-app@0.1.9",
    "db-evo@1.1.4",
    "db-evo@1.1.5",
    "devextreme-angular-rpk@21.2.8",
    "devextreme-rpk@21.2.8",
    "ember-browser-services@5.0.2",
    "ember-browser-services@5.0.3",
    "ember-headless-form-yup@1.0.1",
    "ember-headless-form@1.1.2",
    "ember-headless-form@1.1.3",
    "ember-headless-table@2.1.5",
    "ember-headless-table@2.1.6",
    "ember-url-hash-polyfill@1.0.12",
    "ember-url-hash-polyfill@1.0.13",
    "ember-velcro@2.2.1",
    "ember-velcro@2.2.2",
    "encounter-playground@0.0.2",
    "encounter-playground@0.0.3",
    "encounter-playground@0.0.4",
    "encounter-playground@0.0.5",
    "eslint-config-crowdstrike-node@4.0.3",
    "eslint-config-crowdstrike-node@4.0.4",
    "eslint-config-crowdstrike@11.0.2",
    "eslint-config-crowdstrike@11.0.3",
    "eslint-config-teselagen@6.1.7",
    "eslint-config-teselagen@6.1.8",
    "globalize-rpk@1.7.4",
    "graphql-sequelize-teselagen@5.3.8",
    "graphql-sequelize-teselagen@5.3.9",
    "html-to-base64-image@1.0.2",
    "json-rules-engine-simplified@0.2.1",
    "json-rules-engine-simplified@0.2.2",
    "json-rules-engine-simplified@0.2.3",
    "json-rules-engine-simplified@0.2.4",
    "jumpgate@0.0.2",
    "koa2-swagger-ui@5.11.1",
    "koa2-swagger-ui@5.11.2",
    "mcfly-semantic-release@1.3.1",
    "mcp-knowledge-base@0.0.2",
    "mcp-knowledge-graph@1.2.1",
    "mobioffice-cli@1.0.3",
    "monorepo-next@13.0.1",
    "monorepo-next@13.0.2",
    "mstate-angular@0.4.4",
    "mstate-cli@0.4.7",
    "mstate-dev-react@1.1.1",
    "mstate-react@1.6.5",
    "ng-imports-checker@0.0.10",
    "ng-imports-checker@0.0.9",
    "ng2-file-upload@7.0.2",
    "ng2-file-upload@7.0.3",
    "ng2-file-upload@8.0.1",
    "ng2-file-upload@8.0.2",
    "ng2-file-upload@8.0.3",
    "ng2-file-upload@9.0.1",
    "ngx-bootstrap@18.1.4",
    "ngx-bootstrap@19.0.3",
    "ngx-bootstrap@19.0.4",
    "ngx-bootstrap@20.0.3",
    "ngx-bootstrap@20.0.4",
    "ngx-bootstrap@20.0.5",
    "ngx-bootstrap@20.0.6",
    "ngx-color@10.0.1",
    "ngx-color@10.0.2",
    "ngx-toastr@19.0.1",
    "ngx-toastr@19.0.2",
    "ngx-trend@8.0.1",
    "ngx-ws@1.1.5",
    "ngx-ws@1.1.6",
    "oradm-to-gql@35.0.14",
    "oradm-to-gql@35.0.15",
    "oradm-to-sqlz@1.1.2",
    "oradm-to-sqlz@1.1.3",
    "oradm-to-sqlz@1.1.4",
    "oradm-to-sqlz@1.1.5",
    "ove-auto-annotate@0.0.10",
    "ove-auto-annotate@0.0.9",
    "pm2-gelf-json@1.0.4",
    "pm2-gelf-json@1.0.5",
    "printjs-rpk@1.6.1",
    "react-complaint-image@0.0.32",
    "react-complaint-image@0.0.33",
    "react-complaint-image@0.0.34",
    "react-complaint-image@0.0.35",
    "react-jsonschema-form-conditionals@0.3.18",
    "react-jsonschema-form-conditionals@0.3.19",
    "react-jsonschema-form-conditionals@0.3.20",
    "react-jsonschema-form-conditionals@0.3.21",
    "react-jsonschema-form-extras@1.0.1",
    "react-jsonschema-form-extras@1.0.2",
    "react-jsonschema-form-extras@1.0.3",
    "react-jsonschema-form-extras@1.0.4",
    "react-jsonschema-rxnt-extras@0.4.6",
    "react-jsonschema-rxnt-extras@0.4.7",
    "react-jsonschema-rxnt-extras@0.4.8",
    "react-jsonschema-rxnt-extras@0.4.9",
    "remark-preset-lint-crowdstrike@4.0.1",
    "remark-preset-lint-crowdstrike@4.0.2",
    "rxnt-authentication@0.0.3",
    "rxnt-authentication@0.0.4",
    "rxnt-authentication@0.0.5",
    "rxnt-authentication@0.0.6",
    "rxnt-healthchecks-nestjs@1.0.2",
    "rxnt-healthchecks-nestjs@1.0.3",
    "rxnt-healthchecks-nestjs@1.0.4",
    "rxnt-healthchecks-nestjs@1.0.5",
    "rxnt-kue@1.0.4",
    "rxnt-kue@1.0.5",
    "rxnt-kue@1.0.6",
    "rxnt-kue@1.0.7",
    "swc-plugin-component-annotate@1.9.1",
    "swc-plugin-component-annotate@1.9.2",
    "tbssnch@1.0.2",
    "teselagen-interval-tree@1.1.2",
    "tg-client-query-builder@2.14.4",
    "tg-client-query-builder@2.14.5",
    "tg-redbird@1.3.1",
    "tg-redbird@1.3.2",
    "tg-seq-gen@1.0.10",
    "tg-seq-gen@1.0.9",
    "thangved-react-grid@1.0.3",
    "ts-gaussian@3.0.5",
    "ts-gaussian@3.0.6",
    "ts-imports@1.0.1",
    "ts-imports@1.0.2",
    "tvi-cli@0.1.5",
    "ve-bamreader@0.2.6",
    "ve-bamreader@0.2.7",
    "ve-editor@1.0.1",
    "ve-editor@1.0.2",
    "verror-extra@6.0.1",
    "voip-callkit@1.0.2",
    "voip-callkit@1.0.3",
    "wdio-web-reporter@0.1.3",
    "yargs-help-output@5.0.3",
    "yoo-styles@6.0.326",
    "@ahmedhfarag/ngx-perfect-scrollbar",
    "@ahmedhfarag/ngx-virtual-scroller",
    "ahmedhfarag",
    "@art-ws/common",
    "@art-ws/config-eslint",
    "@art-ws/config-ts",
    "@art-ws/db-context",
    "@art-ws/di-node",
    "@art-ws/di",
    "@art-ws/eslint",
    "@art-ws/fastify-http-server",
    "@art-ws/http-server",
    "@art-ws/openapi",
    "@art-ws/package-base",
    "@art-ws/prettier",
    "@art-ws/slf",
    "@art-ws/ssl-info",
    "@art-ws/web-app",
    "art-ws",
    "@basic-ui-components-stc/basic-ui-components",
    "@crowdstrike/commitlint",
    "@crowdstrike/falcon-shoelace",
    "@crowdstrike/foundry-js",
    "@crowdstrike/glide-core",
    "@crowdstrike/logscale-dashboard",
    "@crowdstrike/logscale-file-editor",
    "@crowdstrike/logscale-parser-edit",
    "@crowdstrike/logscale-search",
    "@crowdstrike/tailwind-toucan-base",
    "crowdstrike",
    "@ctrl/deluge",
    "@ctrl/golang-template",
    "@ctrl/magnet-link",
    "@ctrl/ngx-codemirror",
    "@ctrl/ngx-csv",
    "@ctrl/ngx-emoji-mart",
    "@ctrl/ngx-rightclick",
    "@ctrl/qbittorrent",
    "@ctrl/react-adsense",
    "@ctrl/shared-torrent",
    "@ctrl/tinycolor",
    "@ctrl/torrent-file",
    "@ctrl/transmission",
    "@ctrl/ts-base32",
    "ctrl",
    "@hestjs/core",
    "@hestjs/cqrs",
    "@hestjs/demo",
    "@hestjs/eslint-config",
    "@hestjs/logger",
    "@hestjs/scalar",
    "@hestjs/validation",
    "hestjs",
    "@nativescript-community/arraybuffers",
    "@nativescript-community/gesturehandler",
    "@nativescript-community/perms",
    "@nativescript-community/sentry",
    "@nativescript-community/sqlite",
    "@nativescript-community/text",
    "@nativescript-community/typeorm",
    "@nativescript-community/ui-collectionview",
    "@nativescript-community/ui-document-picker",
    "@nativescript-community/ui-drawer",
    "@nativescript-community/ui-image",
    "@nativescript-community/ui-label",
    "@nativescript-community/ui-material-bottom-navigation",
    "@nativescript-community/ui-material-bottomsheet",
    "@nativescript-community/ui-material-core-tabs",
    "@nativescript-community/ui-material-core",
    "@nativescript-community/ui-material-ripple",
    "@nativescript-community/ui-material-tabs",
    "@nativescript-community/ui-pager",
    "@nativescript-community/ui-pulltorefresh",
    "nativescript-community",
    "@nexe/config-manager",
    "@nexe/eslint-config",
    "@nexe/logger",
    "nexe",
    "@nstudio/angular",
    "@nstudio/focus",
    "@nstudio/nativescript-checkbox",
    "@nstudio/nativescript-loading-indicator",
    "@nstudio/ui-collectionview",
    "@nstudio/web-angular",
    "@nstudio/web",
    "@nstudio/xplat-utils",
    "@nstudio/xplat",
    "nstudio",
    "@operato/board",
    "@operato/data-grist",
    "@operato/graphql",
    "@operato/headroom",
    "@operato/help",
    "@operato/i18n",
    "@operato/input",
    "@operato/layout",
    "@operato/popup",
    "@operato/pull-to-refresh",
    "@operato/shell",
    "@operato/styles",
    "@operato/utils",
    "operato",
    "@teselagen/bio-parsers",
    "@teselagen/bounce-loader",
    "@teselagen/file-utils",
    "@teselagen/liquibase-tools",
    "@teselagen/ove",
    "@teselagen/range-utils",
    "@teselagen/react-list",
    "@teselagen/react-table",
    "@teselagen/sequence-utils",
    "@teselagen/ui",
    "teselagen",
    "@thangved/callback-window",
    "@things-factory/attachment-base",
    "@things-factory/auth-base",
    "@things-factory/email-base",
    "@things-factory/env",
    "@things-factory/integration-base",
    "@things-factory/integration-marketplace",
    "@things-factory/shell",
    "things-factory",
    "@tnf-dev/api",
    "@tnf-dev/core",
    "@tnf-dev/js",
    "@tnf-dev/mui",
    "@tnf-dev/react",
    "tnf-dev",
    "@ui-ux-gang/devextreme-angular-rpk",
    "@ui-ux-gang/devextreme-rpk",
    "ui-ux-gang",
    "@yoobic/design-system",
    "@yoobic/jpeg-camera-es6",
    "@yoobic/yobi",
    "yoobic",
    "ace-colorpicker-rpk",
    "airchief",
    "airpilot",
    "angulartics2",
    "another-shai",
    "browser-webdriver-downloader",
    "capacitor-notificationhandler",
    "capacitor-plugin-healthapp",
    "capacitor-plugin-ihealth",
    "capacitor-plugin-vonage",
    "capacitorandroidpermissions",
    "config-cordova",
    "cordova-plugin-voxeet2",
    "cordova-voxeet",
    "create-hest-app",
    "db-evo",
    "devextreme-angular-rpk",
    "devextreme-rpk",
    "ember-browser-services",
    "ember-headless-form-yup",
    "ember-headless-form",
    "ember-headless-table",
    "ember-url-hash-polyfill",
    "ember-velcro",
    "encounter-playground",
    "eslint-config-crowdstrike-node",
    "eslint-config-crowdstrike",
    "eslint-config-teselagen",
    "globalize-rpk",
    "graphql-sequelize-teselagen",
    "html-to-base64-image",
    "json-rules-engine-simplified",
    "jumpgate",
    "koa2-swagger-ui",
    "mcfly-semantic-release",
    "mcp-knowledge-base",
    "mcp-knowledge-graph",
    "mobioffice-cli",
    "monorepo-next",
    "mstate-angular",
    "mstate-cli",
    "mstate-dev-react",
    "mstate-react",
    "ng-imports-checker",
    "ng2-file-upload",
    "ngx-bootstrap",
    "ngx-color",
    "ngx-toastr",
    "ngx-trend",
    "ngx-ws",
    "oradm-to-gql",
    "oradm-to-sqlz",
    "ove-auto-annotate",
    "pm2-gelf-json",
    "printjs-rpk",
    "react-complaint-image",
    "react-jsonschema-form-conditionals",
    "react-jsonschema-form-extras",
    "react-jsonschema-rxnt-extras",
    "remark-preset-lint-crowdstrike",
    "rxnt-authentication",
    "rxnt-healthchecks-nestjs",
    "rxnt-kue",
    "swc-plugin-component-annotate",
    "tbssnch",
    "teselagen-interval-tree",
    "tg-client-query-builder",
    "tg-redbird",
    "tg-seq-gen",
    "thangved-react-grid",
    "ts-gaussian",
    "ts-imports",
    "tvi-cli",
    "ve-bamreader",
    "ve-editor",
    "verror-extra",
    "voip-callkit",
    "wdio-web-reporter",
    "yargs-help-output",
    "yoo-styles",
    "@ahmedhfarag/*",
    "@art-ws/*",
    "@crowdstrike/*",
    "@ctrl/*",
    "@hestjs/*",
    "@nativescript-community/*",
    "@nstudio/*",
    "@operato/*",
    "@teselagen/*",
    "@things-factory/*",
    "@tnf-dev/*",
    "@ui-ux-gang/*",
    "@yoobic/*",
    "*-rpk",
    "*-angular",
    "*-react",
    "*-cli",
    "*-config",
    "*-plugin",
    "*-utils",
    "*-tools",
    "*-server",
    "*-base",
    "*-editor",
    "*-viewer",
    "*-picker",
    "*-loader",
    "*-parser",
    "*-table",
    "*-form",
    "*-grid",
    "*-image",
    "*-color",
    "*-upload",
    "*-toastr",
    "*-trend",
    "*-ws",
    "*-gql",
    "*-sqlz",
    "*-auto",
    "*-gelf",
    "*-json",
    "*-tree",
    "*-query",
    "*-builder",
    "*-bird",
    "*-gen",
    "*-reader",
    "*-extra",
    "*-callkit",
    "*-reporter",
    "*-output",
    "*-styles"
]
var conteudo;
var danos = [];

function cortarDepois(texto, alvo) {
    const pos = texto.indexOf(alvo);
    if (pos === -1) return texto;
    return texto.slice(0, pos);
}

function corresponde(texto, padrao) {
    var regex = new RegExp(
        padrao.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"),
        "i"
    );
    return regex.test(texto);
}

function registrarDano(item) {
    if (danos.indexOf(item) === -1) {
        danos.push(item);
    }
}

function buscarPackage(inicio) {
    var inicioadaptado = cortarDepois(inicio, "node_modules");
    var itens = fs.readdirSync(inicioadaptado);

    var caminhoPackageLock = null;

    for (var i = 0; i < itens.length; i++) {
        var item = itens[i];
        var caminho = path.join(inicioadaptado, item);

        if (item === "package.json") {
            return caminho;
        }

        if (item === "package-lock.json") {
            caminhoPackageLock = caminho;
        }
    }

    return caminhoPackageLock;
}

function ValidarBibliotecas(PackageLock, packageJson) {
    if (PackageLock && PackageLock.packages) {
        var pacotesInstalados = Object.keys(PackageLock.packages);

        pacotesInstalados.forEach(function (instalado) {
            arrayListPackageShaiHulud.forEach(function (padrao) {
                if (corresponde(instalado, padrao)) {
                    console.log(
                        "âš  SEMELHANÃ‡A DETECTADA | PadrÃ£o: \"" +
                        padrao +
                        "\" | Encontrado em package-lock: \"" +
                        instalado +
                        "\""
                    );

                    registrarDano(instalado);
                }
            });
        });
    }

    if (packageJson && packageJson.dependencies) {
        var pacotesInstalados = Object.keys(packageJson.dependencies);

        pacotesInstalados.forEach(function (instalado) {
            arrayListPackageShaiHulud.forEach(function (padrao) {
                if (corresponde(instalado, padrao)) {
                    console.log(
                        "âš  SEMELHANÃ‡A DETECTADA | PadrÃ£o: \"" +
                        padrao +
                        "\" | Encontrado em package-lock: \"" +
                        instalado +
                        "\""
                    );

                    registrarDano(instalado);
                }
            });
        });
    }
}

function testShaiHuludCLI() {
    console.log("ðŸ” Procurando package-lock.json...");

    var caminhoPackageLock = buscarPackage(process.cwd());
    if (!caminhoPackageLock) {
        console.log("âŒ Nenhum package-lock.json encontrado no projeto.");
        return [{ status: -1, danos: [] }];
    }

    console.log("ðŸ“¦ package-lock encontrado em:", caminhoPackageLock);
    if(caminhoPackageLock.indexOf('package-lock') == -1){
        conteudo = JSON.parse(fs.readFileSync(caminhoPackageLock, "utf-8"));
        ValidarBibliotecas(null, conteudo)
    } else{
        conteudo = JSON.parse(fs.readFileSync(caminhoPackageLock, "utf-8"));
        ValidarBibliotecas(conteudo)
    }

    if (danos.length > 0) {
        console.log("âš  Libs suspeitas foram encontradas nesse projeto");
        console.log(danos)
        return [{ status: 1, danos: danos }];
    } else {
        console.log("âœ… Nenhuma lib suspeita encontrada");
        return [{ status: 0, danos: danos }];
    }
}

module.exports = testShaiHuludCLI;
